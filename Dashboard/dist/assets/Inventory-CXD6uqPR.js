import{r as o,j as e}from"./index-DZ6arj1g.js";const V=()=>{const[k,j]=o.useState([]),[E,w]=o.useState(!0),[P,A]=o.useState(null),[l,N]=o.useState([]),[x,L]=o.useState(""),[_,h]=o.useState(!1),[i,M]=o.useState("all"),[n,p]=o.useState(1),[f,$]=o.useState(10),[r,c]=o.useState({product:"",sku:"",stock:0,price:0,variants:"",image:null,amazon:!1,flipkart:!1});o.useEffect(()=>{fetch("https://e-commerce-mern-backend-ls42.onrender.com/api/products").then(t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}).then(t=>{console.log("Products fetched:",t),j(t),w(!1)}).catch(t=>{console.error("Error fetching products:",t),A(t instanceof Error?t.message:"Unknown error"),w(!1)})},[]);const S=k.filter(s=>{const t=s.product.toLowerCase().includes(x.toLowerCase())||s.sku.toLowerCase().includes(x.toLowerCase()),a=i==="all"||i==="in_stock"&&s.stock>0||i==="out_of_stock"&&s.stock===0||i==="low_stock"&&s.stock>0&&s.stock<10;return t&&a}),m=S.length,d=Math.ceil(m/f),b=(n-1)*f,v=b+f,g=S.slice(b,v);o.useEffect(()=>{p(1)},[x,i]);const I=s=>{N(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s])},z=()=>{const s=g.map(t=>t._id);N(l.length===s.length?[]:s)},B=s=>s===0?{text:"Out of stock",class:"bg-red-100 text-red-800"}:s<10?{text:"Low stock",class:"bg-yellow-100 text-yellow-800"}:{text:"In stock",class:"bg-green-100 text-green-800"},T=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),U=s=>{s>=1&&s<=d&&p(s)},R=()=>{n<d&&p(n+1)},D=()=>{n>1&&p(n-1)},F=async s=>{s.preventDefault();const t=new FormData;t.append("product",r.product),t.append("sku",r.sku),t.append("stock",r.stock.toString()),t.append("price",r.price.toString()),t.append("variants",r.variants),t.append("status","active");const a=[];r.amazon&&a.push("amazon"),r.flipkart&&a.push("flipkart"),t.append("marketplaces",JSON.stringify(a)),r.image&&t.append("image",r.image);try{const u="https://e-commerce-mern-backend-ls42.onrender.com",y=await fetch(`${u}/api/products`,{method:"POST",body:t});if(y.ok){const q=await y.json();console.log("Product added:",q);const K=await(await fetch(`${u}/api/products`)).json();j(K),c({product:"",sku:"",stock:0,price:0,variants:"",image:null,amazon:!1,flipkart:!1}),h(!1)}else throw new Error("Failed to add product")}catch(u){console.error("Error adding product:",u),alert("Error adding product. Please try again.")}},C=s=>{s==="trash"&&l.length>0&&confirm(`Move ${l.length} product(s) to trash?`)&&(j(k.filter(t=>!l.includes(t._id))),N([]))};return E?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded"})]})]})}):P?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error loading products"}),e.jsx("p",{className:"text-sm text-red-600 mt-1",children:P})]})]})})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Inventory"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Showing ",b+1,"-",Math.min(v,m)," of ",m," products"]})]}),e.jsx("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200",children:"Add Product"})]}),_&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Add New Product"}),e.jsx("button",{onClick:()=>h(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name *"}),e.jsx("input",{type:"text",required:!0,placeholder:"Enter product name",value:r.product,onChange:s=>c({...r,product:s.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SKU *"}),e.jsx("input",{type:"text",required:!0,placeholder:"Enter SKU",value:r.sku,onChange:s=>c({...r,sku:s.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stock *"}),e.jsx("input",{type:"number",required:!0,min:"0",placeholder:"Enter stock quantity",value:r.stock,onChange:s=>c({...r,stock:parseInt(s.target.value)||0}),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price *"}),e.jsx("input",{type:"number",required:!0,min:"0",step:"0.01",placeholder:"Enter price",value:r.price,onChange:s=>c({...r,price:parseFloat(s.target.value)||0}),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Variants"}),e.jsx("input",{type:"text",placeholder:"Enter variants (comma separated)",value:r.variants,onChange:s=>c({...r,variants:s.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>c({...r,image:s.target.files?.[0]||null}),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Marketplaces"}),e.jsxs("div",{className:"flex space-x-6",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:r.amazon,onChange:s=>c({...r,amazon:s.target.checked}),className:"h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Amazon"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:r.flipkart,onChange:s=>c({...r,flipkart:s.target.checked}),className:"h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Flipkart"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Add Product"})]})]})]})})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[l.length>0&&e.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-blue-50 rounded-lg mb-4",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[l.length," product",l.length!==1?"s":""," selected"]}),e.jsxs("select",{onChange:s=>C(s.target.value),className:"text-sm border border-gray-300 rounded-md px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Bulk actions"}),e.jsx("option",{value:"trash",children:"Move to trash"})]}),e.jsx("button",{onClick:()=>C("trash"),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Apply"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search products by name or SKU...",value:x,onChange:s=>L(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),e.jsxs("select",{value:i,onChange:s=>M(s.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All stock status"}),e.jsx("option",{value:"in_stock",children:"In stock"}),e.jsx("option",{value:"out_of_stock",children:"Out of stock"}),e.jsx("option",{value:"low_stock",children:"Low stock"})]}),e.jsxs("select",{value:f,onChange:s=>$(Number(s.target.value)),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"5",children:"5 per page"}),e.jsx("option",{value:"10",children:"10 per page"}),e.jsx("option",{value:"20",children:"20 per page"}),e.jsx("option",{value:"50",children:"50 per page"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"w-12 px-6 py-3",children:e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:l.length===g.length&&g.length>0,onChange:z})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date Added"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("svg",{className:"w-12 h-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2M4 13h2m8-8V4a1 1 0 00-1-1h-2a1 1 0 00-1 1v1M9 7h6"})}),e.jsx("p",{className:"text-gray-500 text-lg font-medium",children:"No products found"}),e.jsx("p",{className:"text-gray-400 mt-1",children:x?"Try adjusting your search terms":"Get started by adding your first product"})]})})}):g.map(s=>{const t=B(s.stock),a=l.includes(s._id);return e.jsxs("tr",{className:`hover:bg-gray-50 transition-colors duration-150 ${a?"bg-blue-50":""}`,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:a,onChange:()=>I(s._id)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[s.image?e.jsx("img",{src:`https://e-commerce-mern-backend-ls42.onrender.com/uploads/${s.image}`,alt:s.product,className:"w-10 h-10 rounded-lg object-cover bg-gray-100",onError:u=>{const y=u.target;y.style.display="none"}}):e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:"ðŸ“¦"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.product}),s.variants&&s.variants.length>0&&e.jsx("p",{className:"text-xs text-gray-500 truncate",children:s.variants.join(", ")})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-sm text-gray-900 font-mono bg-gray-100 px-2 py-1 rounded",children:s.sku})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.class}`,children:[t.text,s.stock>0&&` (${s.stock})`]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:["$",s.price.toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-sm text-gray-500",children:T(s.createdAt)})})]},s._id)})})]})}),d>1&&e.jsx("div",{className:"bg-white px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between space-y-3 sm:space-y-0",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:b+1})," to ",e.jsx("span",{className:"font-medium",children:Math.min(v,m)})," of ",e.jsx("span",{className:"font-medium",children:m})," results"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:D,disabled:n===1,className:`px-3 py-1 rounded-md text-sm font-medium ${n===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-300"}`,children:"Previous"}),e.jsx("div",{className:"flex space-x-1",children:Array.from({length:Math.min(5,d)},(s,t)=>{let a;return d<=5||n<=3?a=t+1:n>=d-2?a=d-4+t:a=n-2+t,e.jsx("button",{onClick:()=>U(a),className:`px-3 py-1 rounded-md text-sm font-medium ${n===a?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-300"}`,children:a},a)})}),e.jsx("button",{onClick:R,disabled:n===d,className:`px-3 py-1 rounded-md text-sm font-medium ${n===d?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-300"}`,children:"Next"})]})]})})]})]})};export{V as default};
