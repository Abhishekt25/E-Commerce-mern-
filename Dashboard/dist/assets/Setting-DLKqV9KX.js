import{r as o,j as e}from"./index-D5mzKDxA.js";const v=()=>{const[u,b]=o.useState([]),[f,h]=o.useState(!1),[y,c]=o.useState(!1),[t,l]=o.useState({name:"",email:"",password:"",role:"user"}),n="https://e-commerce-mern-backend-ls42.onrender.com",i=localStorage.getItem("token");o.useEffect(()=>{d()},[]);const d=async()=>{try{h(!0);const s=await fetch(`${n}/api/users`,{headers:{Authorization:`Bearer ${i}`}});if(!s.ok){if(s.status===403){alert("Access denied. Admin role required.");return}throw new Error("Failed to fetch users")}const r=await s.json();b(r)}catch(s){console.error("Error fetching users:",s),alert("Failed to load users")}finally{h(!1)}},j=async s=>{s.preventDefault();try{const r=await fetch(`${n}/api/create-user`,{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const a=await r.json();throw new Error(a.message||"Failed to create user")}alert("User created successfully!"),c(!1),l({name:"",email:"",password:"",role:"user"}),d()}catch(r){console.error("Error creating user:",r),alert(r.message||"Failed to create user")}},g=async(s,r)=>{try{const a=await fetch(`${n}/api/users/${s}/role`,{method:"PUT",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify({role:r})});if(!a.ok){const N=await a.json();throw new Error(N.message||"Failed to update role")}alert("Role updated successfully!"),d()}catch(a){console.error("Error updating role:",a),alert(a.message||"Failed to update role")}},p=async s=>{if(confirm("Are you sure you want to delete this user?"))try{const r=await fetch(`${n}/api/users/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${i}`}});if(!r.ok){const a=await r.json();throw new Error(a.message||"Failed to delete user")}alert("User deleted successfully!"),d()}catch(r){console.error("Error deleting user:",r),alert(r.message||"Failed to delete user")}},m=u.filter(s=>s.role==="admin"),x=u.filter(s=>s.role==="user");return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"User Management"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage users and their roles"})]}),e.jsx("button",{onClick:()=>c(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"Create New User"})]}),f?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading users..."})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Admin Users"}),e.jsxs("span",{className:"bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-semibold",children:[m.length," Admins"]})]}),e.jsx("div",{className:"space-y-4",children:m.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No admin users found"}):m.map(s=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-gray-600 text-sm",children:s.email}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Joined: ",new Date(s.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>g(s._id,"user"),className:"bg-yellow-500 text-white px-3 py-1 rounded text-sm hover:bg-yellow-600 transition-colors",children:"Make User"}),e.jsx("button",{onClick:()=>p(s._id),className:"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition-colors",children:"Delete"})]})]})},s._id))})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Regular Users"}),e.jsxs("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold",children:[x.length," Users"]})]}),e.jsx("div",{className:"space-y-4",children:x.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No regular users found"}):x.map(s=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-gray-600 text-sm",children:s.email}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Joined: ",new Date(s.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>g(s._id,"admin"),className:"bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600 transition-colors",children:"Make Admin"}),e.jsx("button",{onClick:()=>p(s._id),className:"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition-colors",children:"Delete"})]})]})},s._id))})]})]}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Create New User"}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",required:!0,value:t.name,onChange:s=>l({...t,name:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",required:!0,value:t.email,onChange:s=>l({...t,email:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{type:"password",required:!0,value:t.password,onChange:s=>l({...t,password:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:t.role,onChange:s=>l({...t,role:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"Create User"}),e.jsx("button",{type:"button",onClick:()=>c(!1),className:"flex-1 bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors font-semibold",children:"Cancel"})]})]})]})})]})})};export{v as default};
