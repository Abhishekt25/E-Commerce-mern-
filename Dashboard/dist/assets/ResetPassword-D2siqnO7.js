import{r as o,u as b,a as y,j as e}from"./index-DDtxi5zw.js";import{u as P}from"./index.esm-BUqdZG6_.js";const k=()=>{const[n,t]=o.useState(null),[i,c]=o.useState(null),[r,d]=o.useState(!1),{register:l,handleSubmit:p,watch:x,formState:{errors:s}}=P(),w=b(),g=y(),h="https://e-commerce-mern-backend-ls42.onrender.com",m=new URLSearchParams(g.search).get("token"),f=async a=>{if(!m){t("Invalid or missing token. Please check your email link.");return}try{if(d(!0),t(null),c(null),!(await fetch(`${h}/api/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:m,password:a.password})})).ok)throw new Error("Failed to reset password. Please try again.");c("Password reset successful! Redirecting to Sign In..."),setTimeout(()=>w("/signin"),2500)}catch(u){t(u.message||"Something went wrong. Try again.")}finally{d(!1)}};return e.jsxs("div",{className:"max-w-md mx-auto mt-20 p-6 bg-white shadow-lg rounded-2xl",children:[e.jsx("h2",{className:"text-3xl font-semibold mb-6 text-center text-gray-800",children:"Reset Password"}),n&&e.jsx("p",{className:"text-red-500 text-center mb-4",children:n}),i&&e.jsx("p",{className:"text-green-500 text-center mb-4",children:i}),e.jsxs("form",{onSubmit:p(f),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),e.jsx("input",{type:"password",...l("password",{required:"Password is required",minLength:{value:6,message:"Minimum 6 characters"}}),className:"w-full mt-1 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400"}),s.password&&e.jsx("span",{className:"text-red-500 text-sm",children:s.password?.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),e.jsx("input",{type:"password",...l("confirmPassword",{required:"Please confirm your password",validate:a=>a===x("password")||"Passwords do not match"}),className:"w-full mt-1 px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400"}),s.confirmPassword&&e.jsx("span",{className:"text-red-500 text-sm",children:s.confirmPassword?.message})]}),e.jsx("button",{type:"submit",disabled:r,className:`w-full bg-blue-500 text-white py-2 rounded-md hover:bg-blue-600 transition ${r?"opacity-70 cursor-not-allowed":""}`,children:r?"Resetting...":"Reset Password"})]})]})};export{k as default};
